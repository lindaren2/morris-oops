{"version":3,"file":"thisissoon-angular-inviewport.js.map","sources":["ng://@thisissoon/angular-inviewport/app/window/window-token.ts","ng://@thisissoon/angular-inviewport/app/in-viewport/in-viewport.directive.ts","ng://@thisissoon/angular-inviewport/app/window/window-mock.ts","ng://@thisissoon/angular-inviewport/app/in-viewport/in-viewport.module.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\n\nexport const WINDOW = new InjectionToken<Window>('WINDOW', {\n  providedIn: 'root',\n  factory: () => window\n});\n","import {\n  Directive,\n  ElementRef,\n  HostBinding,\n  EventEmitter,\n  Output,\n  OnDestroy,\n  AfterViewInit,\n  Inject,\n  Input,\n  OnInit\n} from '@angular/core';\nimport { WINDOW } from '../window/window-token';\n\n/**\n * A simple lightweight library for Angular with that detects when an\n * element is within the browsers viewport and adds a `in-viewport` or\n * `not-in-viewport` class to the element.\n *\n * @example\n * ```html\n * <p\n *  class=\"foo\"\n *  snInViewport\n *  (inViewportChange)=\"myEventHandler($event)\">\n *  Amet tempor excepteur occaecat nulla.\n * </p>\n * ```\n */\n// @dynamic\n@Directive({\n  selector: '[snInViewport]',\n  exportAs: 'snInViewport'\n})\nexport class InViewportDirective implements AfterViewInit, OnDestroy, OnInit {\n  private inViewport: boolean;\n  private hasIntersectionObserver: boolean;\n  @Input()\n  inViewportOptions: IntersectionObserverInit;\n  @Output()\n  inViewportChange = new EventEmitter<boolean>();\n  observer: IntersectionObserver;\n\n  @HostBinding('class.sn-viewport--in')\n  get isInViewport(): boolean {\n    return this.inViewport;\n  }\n\n  @HostBinding('class.sn-viewport--out')\n  get isNotInViewport(): boolean {\n    return !this.inViewport;\n  }\n\n  constructor(private el: ElementRef, @Inject(WINDOW) private window: Window) {\n    this.hasIntersectionObserver = this.intersectionObserverFeatureDetection();\n  }\n\n  ngOnInit() {\n    if (!this.hasIntersectionObserver) {\n      this.inViewport = true;\n      this.inViewportChange.emit(this.inViewport);\n    }\n  }\n\n  ngAfterViewInit() {\n    if (this.hasIntersectionObserver) {\n      const IntersectionObserver = this.window['IntersectionObserver'];\n      this.observer = new IntersectionObserver(\n        this.intersectionObserverCallback.bind(this),\n        this.inViewportOptions\n      );\n\n      this.observer.observe(this.el.nativeElement);\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.observer) {\n      this.observer.unobserve(this.el.nativeElement);\n    }\n  }\n\n  intersectionObserverCallback(entries: IntersectionObserverEntry[]) {\n    entries.forEach(entry => {\n      if (this.inViewport === entry.isIntersecting) return;\n      this.inViewport = entry.isIntersecting;\n      this.inViewportChange.emit(this.inViewport);\n    });\n  }\n\n  private intersectionObserverFeatureDetection() {\n    // Exits early if all IntersectionObserver and IntersectionObserverEntry\n    // features are natively supported.\n    if (\n      'IntersectionObserver' in this.window &&\n      'IntersectionObserverEntry' in this.window\n    ) {\n      // Minimal polyfill for Edge 15's lack of `isIntersecting`\n      // See: https://github.com/w3c/IntersectionObserver/issues/211\n      if (\n        !(\n          'isIntersecting' in\n          this.window['IntersectionObserverEntry']['prototype']\n        )\n      ) {\n        Object.defineProperty(\n          this.window['IntersectionObserverEntry']['prototype'],\n          'isIntersecting',\n          {\n            get: function() {\n              return this.intersectionRatio > 0;\n            }\n          }\n        );\n      }\n      return true;\n    }\n    return false;\n  }\n}\n","export const WINDOW_MOCK_WITHOUT_INTERSECTION_OBSERVER = {\n  closed: null,\n  defaultStatus: null,\n  document: null,\n  frameElement: null,\n  frames: null,\n  history: null,\n  innerHeight: null,\n  innerWidth: null,\n  length: null,\n  localStorage: null,\n  location: null,\n  name: null,\n  navigator: null,\n  opener: null,\n  outerHeight: null,\n  outerWidth: null,\n  pageXOffset: null,\n  pageYOffset: null,\n  parent: null,\n  screen: null,\n  screenLeft: null,\n  screenTop: null,\n  screenX: null,\n  screenY: null,\n  sessionStorage: null,\n  scrollX: null,\n  scrollY: null,\n  self: null,\n  status: null,\n  top: null,\n  addEventListener: (...args) => null,\n  alert: (...args) => null,\n  atob: (...args) => null,\n  blur: (...args) => null,\n  btoa: (...args) => null,\n  clearInterval: (...args) => null,\n  clearTimeout: (...args) => null,\n  close: (...args) => null,\n  confirm: (...args) => null,\n  focus: (...args) => null,\n  getComputedStyle: (...args) => null,\n  getSelection: (...args) => null,\n  matchMedia: (...args) => null,\n  moveBy: (...args) => null,\n  moveTo: (...args) => null,\n  open: (...args) => null,\n  print: (...args) => null,\n  prompt: (...args) => null,\n  resizeBy: (...args) => null,\n  resizeTo: (...args) => null,\n  removeEventListener: (...args) => null,\n  scroll: (...args) => null,\n  scrollBy: (...args) => null,\n  scrollTo: (...args) => null,\n  setInterval: (...args) => null,\n  setTimeout: (...args) => null,\n  stop: (...args) => null\n};\n\nexport const WINDOW_MOCK = {\n  ...WINDOW_MOCK_WITHOUT_INTERSECTION_OBSERVER,\n  IntersectionObserver: (...args) => ({\n    observe: () => null,\n    unobserve: () => null\n  }),\n  IntersectionObserverEntry: class IntersectionObserverEntryMock {}\n};\n","import { NgModule, ModuleWithProviders } from '@angular/core';\n\nimport { InViewportDirective } from './in-viewport.directive';\nimport { WINDOW } from '../window/window-token';\nimport { WINDOW_MOCK } from '../window/window-mock';\n\n/**\n * A simple lightweight library for Angular with other dependencies\n * that detects when an element is within the browsers viewport and adds a\n * sn-viewport--in or sn-viewport--out class to the element.\n */\n@NgModule({\n  declarations: [InViewportDirective],\n  exports: [InViewportDirective]\n})\nexport class InViewportModule {\n  static forServer(): ModuleWithProviders {\n    return {\n      ngModule: InViewportModule,\n      providers: [{ provide: WINDOW, useValue: WINDOW_MOCK }]\n    };\n  }\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AAEA,IAAa,MAAM,GAAG,IAAI,cAAc,CAAS,QAAQ,EAAE;IACzD,UAAU,EAAE,MAAM;IAClB,OAAO,EAAE,cAAM,OAAA,MAAM,GAAA;CACtB,CAAC;;;;;;ACLF;;;;;;;;;;;;;;;;AA8BA;IAuBE,6BAAoB,EAAc,EAA0B,MAAc;QAAtD,OAAE,GAAF,EAAE,CAAY;QAA0B,WAAM,GAAN,MAAM,CAAQ;QAb1E,qBAAgB,GAAG,IAAI,YAAY,EAAW,CAAC;QAc7C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,oCAAoC,EAAE,CAAC;KAC5E;IAZD,sBACI,6CAAY;;;;QADhB;YAEE,OAAO,IAAI,CAAC,UAAU,CAAC;SACxB;;;OAAA;IAED,sBACI,gDAAe;;;;QADnB;YAEE,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC;SACzB;;;OAAA;;;;IAMD,sCAAQ;;;IAAR;QACE,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE;YACjC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;YACvB,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAC7C;KACF;;;;IAED,6CAAe;;;IAAf;QACE,IAAI,IAAI,CAAC,uBAAuB,EAAE;;gBAC1B,sBAAoB,GAAG,IAAI,CAAC,MAAM,CAAC,sBAAsB,CAAC;YAChE,IAAI,CAAC,QAAQ,GAAG,IAAI,sBAAoB,CACtC,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,IAAI,CAAC,EAC5C,IAAI,CAAC,iBAAiB,CACvB,CAAC;YAEF,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC;SAC9C;KACF;;;;IAED,yCAAW;;;IAAX;QACE,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC;SAChD;KACF;;;;;IAED,0DAA4B;;;;IAA5B,UAA6B,OAAoC;QAAjE,iBAMC;QALC,OAAO,CAAC,OAAO,CAAC,UAAA,KAAK;YACnB,IAAI,KAAI,CAAC,UAAU,KAAK,KAAK,CAAC,cAAc;gBAAE,OAAO;YACrD,KAAI,CAAC,UAAU,GAAG,KAAK,CAAC,cAAc,CAAC;YACvC,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,CAAC;SAC7C,CAAC,CAAC;KACJ;;;;;IAEO,kEAAoC;;;;IAA5C;;;QAGE,IACE,sBAAsB,IAAI,IAAI,CAAC,MAAM;YACrC,2BAA2B,IAAI,IAAI,CAAC,MAAM,EAC1C;;;YAGA,IACE,EACE,gBAAgB;gBAChB,IAAI,CAAC,MAAM,CAAC,2BAA2B,CAAC,CAAC,WAAW,CAAC,CACtD,EACD;gBACA,MAAM,CAAC,cAAc,CACnB,IAAI,CAAC,MAAM,CAAC,2BAA2B,CAAC,CAAC,WAAW,CAAC,EACrD,gBAAgB,EAChB;oBACE,GAAG,EAAE;wBACH,OAAO,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC;qBACnC;iBACF,CACF,CAAC;aACH;YACD,OAAO,IAAI,CAAC;SACb;QACD,OAAO,KAAK,CAAC;KACd;;gBAxFF,SAAS,SAAC;oBACT,QAAQ,EAAE,gBAAgB;oBAC1B,QAAQ,EAAE,cAAc;iBACzB;;;;gBA/BC,UAAU;gBAmD0D,MAAM,uBAArC,MAAM,SAAC,MAAM;;;oCAhBjD,KAAK;mCAEL,MAAM;+BAIN,WAAW,SAAC,uBAAuB;kCAKnC,WAAW,SAAC,wBAAwB;;IAuEvC,0BAAC;CAzFD;;;;;;;AC9BA,IAAa,yCAAyC,GAAG;IACvD,MAAM,EAAE,IAAI;IACZ,aAAa,EAAE,IAAI;IACnB,QAAQ,EAAE,IAAI;IACd,YAAY,EAAE,IAAI;IAClB,MAAM,EAAE,IAAI;IACZ,OAAO,EAAE,IAAI;IACb,WAAW,EAAE,IAAI;IACjB,UAAU,EAAE,IAAI;IAChB,MAAM,EAAE,IAAI;IACZ,YAAY,EAAE,IAAI;IAClB,QAAQ,EAAE,IAAI;IACd,IAAI,EAAE,IAAI;IACV,SAAS,EAAE,IAAI;IACf,MAAM,EAAE,IAAI;IACZ,WAAW,EAAE,IAAI;IACjB,UAAU,EAAE,IAAI;IAChB,WAAW,EAAE,IAAI;IACjB,WAAW,EAAE,IAAI;IACjB,MAAM,EAAE,IAAI;IACZ,MAAM,EAAE,IAAI;IACZ,UAAU,EAAE,IAAI;IAChB,SAAS,EAAE,IAAI;IACf,OAAO,EAAE,IAAI;IACb,OAAO,EAAE,IAAI;IACb,cAAc,EAAE,IAAI;IACpB,OAAO,EAAE,IAAI;IACb,OAAO,EAAE,IAAI;IACb,IAAI,EAAE,IAAI;IACV,MAAM,EAAE,IAAI;IACZ,GAAG,EAAE,IAAI;IACT,gBAAgB,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACnC,KAAK,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACxB,IAAI,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACvB,IAAI,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACvB,IAAI,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACvB,aAAa,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAChC,YAAY,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC/B,KAAK,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACxB,OAAO,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC1B,KAAK,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACxB,gBAAgB,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACnC,YAAY,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC/B,UAAU,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC7B,MAAM,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACzB,MAAM,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACzB,IAAI,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACvB,KAAK,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACxB,MAAM,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACzB,QAAQ,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC3B,QAAQ,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC3B,mBAAmB,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACtC,MAAM,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IACzB,QAAQ,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC3B,QAAQ,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC3B,WAAW,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC9B,UAAU,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;IAC7B,IAAI,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,OAAA,IAAI;KAAA;CACxB;;AAED,IAAa,WAAW,gBACnB,yCAAyC,IAC5C,oBAAoB,EAAE;QAAC,cAAO;aAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;YAAP,yBAAO;;QAAK,QAAC;YAClC,OAAO,EAAE,cAAM,OAAA,IAAI,GAAA;YACnB,SAAS,EAAE,cAAM,OAAA,IAAI,GAAA;SACtB;KAAC,EACF,yBAAyB;QAAE;SAAsC;QAAD,oCAAC;KAAA,MAClE;;;;;;ACnED;;;;;AAWA;IAAA;KAWC;;;;IANQ,0BAAS;;;IAAhB;QACE,OAAO;YACL,QAAQ,EAAE,gBAAgB;YAC1B,SAAS,EAAE,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,CAAC;SACxD,CAAC;KACH;;gBAVF,QAAQ,SAAC;oBACR,YAAY,EAAE,CAAC,mBAAmB,CAAC;oBACnC,OAAO,EAAE,CAAC,mBAAmB,CAAC;iBAC/B;;IAQD,uBAAC;CAXD;;;;;;;;;;;;;;"}
