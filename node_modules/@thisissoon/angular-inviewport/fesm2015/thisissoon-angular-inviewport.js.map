{"version":3,"file":"thisissoon-angular-inviewport.js.map","sources":["ng://@thisissoon/angular-inviewport/app/window/window-token.ts","ng://@thisissoon/angular-inviewport/app/in-viewport/in-viewport.directive.ts","ng://@thisissoon/angular-inviewport/app/window/window-mock.ts","ng://@thisissoon/angular-inviewport/app/in-viewport/in-viewport.module.ts"],"sourcesContent":["import { InjectionToken } from '@angular/core';\n\nexport const WINDOW = new InjectionToken<Window>('WINDOW', {\n  providedIn: 'root',\n  factory: () => window\n});\n","import {\n  Directive,\n  ElementRef,\n  HostBinding,\n  EventEmitter,\n  Output,\n  OnDestroy,\n  AfterViewInit,\n  Inject,\n  Input,\n  OnInit\n} from '@angular/core';\nimport { WINDOW } from '../window/window-token';\n\n/**\n * A simple lightweight library for Angular with that detects when an\n * element is within the browsers viewport and adds a `in-viewport` or\n * `not-in-viewport` class to the element.\n *\n * @example\n * ```html\n * <p\n *  class=\"foo\"\n *  snInViewport\n *  (inViewportChange)=\"myEventHandler($event)\">\n *  Amet tempor excepteur occaecat nulla.\n * </p>\n * ```\n */\n// @dynamic\n@Directive({\n  selector: '[snInViewport]',\n  exportAs: 'snInViewport'\n})\nexport class InViewportDirective implements AfterViewInit, OnDestroy, OnInit {\n  private inViewport: boolean;\n  private hasIntersectionObserver: boolean;\n  @Input()\n  inViewportOptions: IntersectionObserverInit;\n  @Output()\n  inViewportChange = new EventEmitter<boolean>();\n  observer: IntersectionObserver;\n\n  @HostBinding('class.sn-viewport--in')\n  get isInViewport(): boolean {\n    return this.inViewport;\n  }\n\n  @HostBinding('class.sn-viewport--out')\n  get isNotInViewport(): boolean {\n    return !this.inViewport;\n  }\n\n  constructor(private el: ElementRef, @Inject(WINDOW) private window: Window) {\n    this.hasIntersectionObserver = this.intersectionObserverFeatureDetection();\n  }\n\n  ngOnInit() {\n    if (!this.hasIntersectionObserver) {\n      this.inViewport = true;\n      this.inViewportChange.emit(this.inViewport);\n    }\n  }\n\n  ngAfterViewInit() {\n    if (this.hasIntersectionObserver) {\n      const IntersectionObserver = this.window['IntersectionObserver'];\n      this.observer = new IntersectionObserver(\n        this.intersectionObserverCallback.bind(this),\n        this.inViewportOptions\n      );\n\n      this.observer.observe(this.el.nativeElement);\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.observer) {\n      this.observer.unobserve(this.el.nativeElement);\n    }\n  }\n\n  intersectionObserverCallback(entries: IntersectionObserverEntry[]) {\n    entries.forEach(entry => {\n      if (this.inViewport === entry.isIntersecting) return;\n      this.inViewport = entry.isIntersecting;\n      this.inViewportChange.emit(this.inViewport);\n    });\n  }\n\n  private intersectionObserverFeatureDetection() {\n    // Exits early if all IntersectionObserver and IntersectionObserverEntry\n    // features are natively supported.\n    if (\n      'IntersectionObserver' in this.window &&\n      'IntersectionObserverEntry' in this.window\n    ) {\n      // Minimal polyfill for Edge 15's lack of `isIntersecting`\n      // See: https://github.com/w3c/IntersectionObserver/issues/211\n      if (\n        !(\n          'isIntersecting' in\n          this.window['IntersectionObserverEntry']['prototype']\n        )\n      ) {\n        Object.defineProperty(\n          this.window['IntersectionObserverEntry']['prototype'],\n          'isIntersecting',\n          {\n            get: function() {\n              return this.intersectionRatio > 0;\n            }\n          }\n        );\n      }\n      return true;\n    }\n    return false;\n  }\n}\n","export const WINDOW_MOCK_WITHOUT_INTERSECTION_OBSERVER = {\n  closed: null,\n  defaultStatus: null,\n  document: null,\n  frameElement: null,\n  frames: null,\n  history: null,\n  innerHeight: null,\n  innerWidth: null,\n  length: null,\n  localStorage: null,\n  location: null,\n  name: null,\n  navigator: null,\n  opener: null,\n  outerHeight: null,\n  outerWidth: null,\n  pageXOffset: null,\n  pageYOffset: null,\n  parent: null,\n  screen: null,\n  screenLeft: null,\n  screenTop: null,\n  screenX: null,\n  screenY: null,\n  sessionStorage: null,\n  scrollX: null,\n  scrollY: null,\n  self: null,\n  status: null,\n  top: null,\n  addEventListener: (...args) => null,\n  alert: (...args) => null,\n  atob: (...args) => null,\n  blur: (...args) => null,\n  btoa: (...args) => null,\n  clearInterval: (...args) => null,\n  clearTimeout: (...args) => null,\n  close: (...args) => null,\n  confirm: (...args) => null,\n  focus: (...args) => null,\n  getComputedStyle: (...args) => null,\n  getSelection: (...args) => null,\n  matchMedia: (...args) => null,\n  moveBy: (...args) => null,\n  moveTo: (...args) => null,\n  open: (...args) => null,\n  print: (...args) => null,\n  prompt: (...args) => null,\n  resizeBy: (...args) => null,\n  resizeTo: (...args) => null,\n  removeEventListener: (...args) => null,\n  scroll: (...args) => null,\n  scrollBy: (...args) => null,\n  scrollTo: (...args) => null,\n  setInterval: (...args) => null,\n  setTimeout: (...args) => null,\n  stop: (...args) => null\n};\n\nexport const WINDOW_MOCK = {\n  ...WINDOW_MOCK_WITHOUT_INTERSECTION_OBSERVER,\n  IntersectionObserver: (...args) => ({\n    observe: () => null,\n    unobserve: () => null\n  }),\n  IntersectionObserverEntry: class IntersectionObserverEntryMock {}\n};\n","import { NgModule, ModuleWithProviders } from '@angular/core';\n\nimport { InViewportDirective } from './in-viewport.directive';\nimport { WINDOW } from '../window/window-token';\nimport { WINDOW_MOCK } from '../window/window-mock';\n\n/**\n * A simple lightweight library for Angular with other dependencies\n * that detects when an element is within the browsers viewport and adds a\n * sn-viewport--in or sn-viewport--out class to the element.\n */\n@NgModule({\n  declarations: [InViewportDirective],\n  exports: [InViewportDirective]\n})\nexport class InViewportModule {\n  static forServer(): ModuleWithProviders {\n    return {\n      ngModule: InViewportModule,\n      providers: [{ provide: WINDOW, useValue: WINDOW_MOCK }]\n    };\n  }\n}\n"],"names":[],"mappings":"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"}
